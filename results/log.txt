2025-11-02 15:42:33,212 - root - INFO - Create log file....
2025-11-02 15:42:33,212 - root - INFO - Create scDMLModel Object Done....
2025-11-02 15:42:33,214 - root - INFO - Running preprocess() function...
2025-11-02 15:42:33,375 - root - INFO - mode=unsupervised
2025-11-02 15:42:33,376 - root - INFO - clustering method=louvain
2025-11-02 15:42:33,376 - root - INFO - resolution=3.0
2025-11-02 15:42:33,377 - root - INFO - BATCH_key=tech
2025-11-02 15:42:33,377 - root - INFO - Normalize counts per cell(sum=10000.0)
2025-11-02 15:42:33,408 - root - INFO - Log1p data
2025-11-02 15:42:33,430 - root - INFO - Select HVG(n_top_genes=1000)
2025-11-02 15:42:33,707 - root - INFO - Scale batch(scale_value=10.0)
2025-11-02 15:42:34,012 - root - INFO - Calculate PCA(n_comps=100)
2025-11-02 15:42:45,060 - root - INFO - Apply louvain clustring(resolution=3.0) initization
2025-11-02 15:42:45,061 - root - INFO - Number of Cluster =42
2025-11-02 15:42:45,061 - root - INFO - clusters=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41]
2025-11-02 15:42:45,062 - root - INFO - Preprocess Dataset Done...
2025-11-02 15:42:45,063 - root - INFO - mode=unsupervised
2025-11-02 15:42:45,091 - root - INFO - K_in=5,K_bw=10
2025-11-02 15:42:45,091 - root - INFO - Calculate similarity of cluster with KNN and MNN
2025-11-02 15:42:45,091 - root - INFO - appoximate calculate KNN Pair intra batch...
2025-11-02 15:42:45,097 - root - INFO - Calculate KNN pair intra batch...........
2025-11-02 15:42:45,097 - root - INFO - K=5
2025-11-02 15:42:45,098 - root - INFO - metric=cosine
2025-11-02 15:42:45,099 - root - INFO - Processing datasets: (0, 0) = ('celseq', 'celseq')
2025-11-02 15:42:45,131 - root - INFO - There are (6760) KNN pairs when processing (0, 0)=('celseq', 'celseq')
2025-11-02 15:42:45,131 - root - INFO - Processing datasets: (1, 1) = ('celseq2', 'celseq2')
2025-11-02 15:42:45,196 - root - INFO - There are (15144) KNN pairs when processing (1, 1)=('celseq2', 'celseq2')
2025-11-02 15:42:45,196 - root - INFO - Processing datasets: (2, 2) = ('fluidigmc1', 'fluidigmc1')
2025-11-02 15:42:45,220 - root - INFO - There are (3958) KNN pairs when processing (2, 2)=('fluidigmc1', 'fluidigmc1')
2025-11-02 15:42:45,220 - root - INFO - Processing datasets: (3, 3) = ('inDrop1', 'inDrop1')
2025-11-02 15:42:45,277 - root - INFO - There are (12572) KNN pairs when processing (3, 3)=('inDrop1', 'inDrop1')
2025-11-02 15:42:45,277 - root - INFO - Processing datasets: (4, 4) = ('inDrop2', 'inDrop2')
2025-11-02 15:42:45,328 - root - INFO - There are (11032) KNN pairs when processing (4, 4)=('inDrop2', 'inDrop2')
2025-11-02 15:42:45,328 - root - INFO - Processing datasets: (5, 5) = ('inDrop3', 'inDrop3')
2025-11-02 15:42:45,424 - root - INFO - There are (24260) KNN pairs when processing (5, 5)=('inDrop3', 'inDrop3')
2025-11-02 15:42:45,424 - root - INFO - Processing datasets: (6, 6) = ('inDrop4', 'inDrop4')
2025-11-02 15:42:45,470 - root - INFO - There are (8382) KNN pairs when processing (6, 6)=('inDrop4', 'inDrop4')
2025-11-02 15:42:45,471 - root - INFO - Processing datasets: (7, 7) = ('smarter', 'smarter')
2025-11-02 15:42:45,528 - root - INFO - There are (9528) KNN pairs when processing (7, 7)=('smarter', 'smarter')
2025-11-02 15:42:45,528 - root - INFO - Processing datasets: (8, 8) = ('smartseq2', 'smartseq2')
2025-11-02 15:42:45,608 - root - INFO - There are (15500) KNN pairs when processing (8, 8)=('smartseq2', 'smartseq2')
2025-11-02 15:42:45,609 - root - INFO - scDML finds (107136) KNN pairs in dataset finally
2025-11-02 15:42:45,670 - root - INFO - appoximate calculate MNN Pair inter batch...
2025-11-02 15:42:45,675 - root - INFO - Calculate MNN pair inter batch...........
2025-11-02 15:42:45,675 - root - INFO - K=10
2025-11-02 15:42:45,676 - root - INFO - metric=cosine
2025-11-02 15:42:45,677 - root - INFO - Processing datasets: (0, 1) = ('celseq', 'celseq2')
2025-11-02 15:42:45,732 - root - INFO - There are (8722) MNN pairs when processing (0, 1)=('celseq', 'celseq2')
2025-11-02 15:42:45,732 - root - INFO - Processing datasets: (0, 2) = ('celseq', 'fluidigmc1')
2025-11-02 15:42:45,765 - root - INFO - There are (5016) MNN pairs when processing (0, 2)=('celseq', 'fluidigmc1')
2025-11-02 15:42:45,765 - root - INFO - Processing datasets: (0, 3) = ('celseq', 'inDrop1')
2025-11-02 15:42:45,815 - root - INFO - There are (7512) MNN pairs when processing (0, 3)=('celseq', 'inDrop1')
2025-11-02 15:42:45,815 - root - INFO - Processing datasets: (0, 4) = ('celseq', 'inDrop2')
2025-11-02 15:42:45,861 - root - INFO - There are (8030) MNN pairs when processing (0, 4)=('celseq', 'inDrop2')
2025-11-02 15:42:45,861 - root - INFO - Processing datasets: (0, 5) = ('celseq', 'inDrop3')
2025-11-02 15:42:45,935 - root - INFO - There are (8962) MNN pairs when processing (0, 5)=('celseq', 'inDrop3')
2025-11-02 15:42:45,935 - root - INFO - Processing datasets: (0, 6) = ('celseq', 'inDrop4')
2025-11-02 15:42:45,977 - root - INFO - There are (7242) MNN pairs when processing (0, 6)=('celseq', 'inDrop4')
2025-11-02 15:42:45,978 - root - INFO - Processing datasets: (0, 7) = ('celseq', 'smarter')
2025-11-02 15:42:46,027 - root - INFO - There are (8202) MNN pairs when processing (0, 7)=('celseq', 'smarter')
2025-11-02 15:42:46,027 - root - INFO - Processing datasets: (0, 8) = ('celseq', 'smartseq2')
2025-11-02 15:42:46,089 - root - INFO - There are (8838) MNN pairs when processing (0, 8)=('celseq', 'smartseq2')
2025-11-02 15:42:46,089 - root - INFO - Processing datasets: (1, 2) = ('celseq2', 'fluidigmc1')
2025-11-02 15:42:46,150 - root - INFO - There are (7576) MNN pairs when processing (1, 2)=('celseq2', 'fluidigmc1')
2025-11-02 15:42:46,150 - root - INFO - Processing datasets: (1, 3) = ('celseq2', 'inDrop1')
2025-11-02 15:42:46,236 - root - INFO - There are (13076) MNN pairs when processing (1, 3)=('celseq2', 'inDrop1')
2025-11-02 15:42:46,236 - root - INFO - Processing datasets: (1, 4) = ('celseq2', 'inDrop2')
2025-11-02 15:42:46,324 - root - INFO - There are (14080) MNN pairs when processing (1, 4)=('celseq2', 'inDrop2')
2025-11-02 15:42:46,324 - root - INFO - Processing datasets: (1, 5) = ('celseq2', 'inDrop3')
2025-11-02 15:42:46,437 - root - INFO - There are (15404) MNN pairs when processing (1, 5)=('celseq2', 'inDrop3')
2025-11-02 15:42:46,438 - root - INFO - Processing datasets: (1, 6) = ('celseq2', 'inDrop4')
2025-11-02 15:42:46,520 - root - INFO - There are (11250) MNN pairs when processing (1, 6)=('celseq2', 'inDrop4')
2025-11-02 15:42:46,520 - root - INFO - Processing datasets: (1, 7) = ('celseq2', 'smarter')
2025-11-02 15:42:46,610 - root - INFO - There are (12532) MNN pairs when processing (1, 7)=('celseq2', 'smarter')
2025-11-02 15:42:46,611 - root - INFO - Processing datasets: (1, 8) = ('celseq2', 'smartseq2')
2025-11-02 15:42:46,714 - root - INFO - There are (15702) MNN pairs when processing (1, 8)=('celseq2', 'smartseq2')
2025-11-02 15:42:46,714 - root - INFO - Processing datasets: (2, 3) = ('fluidigmc1', 'inDrop1')
2025-11-02 15:42:46,786 - root - INFO - There are (7362) MNN pairs when processing (2, 3)=('fluidigmc1', 'inDrop1')
2025-11-02 15:42:46,786 - root - INFO - Processing datasets: (2, 4) = ('fluidigmc1', 'inDrop2')
2025-11-02 15:42:46,857 - root - INFO - There are (7760) MNN pairs when processing (2, 4)=('fluidigmc1', 'inDrop2')
2025-11-02 15:42:46,857 - root - INFO - Processing datasets: (2, 5) = ('fluidigmc1', 'inDrop3')
2025-11-02 15:42:46,956 - root - INFO - There are (8424) MNN pairs when processing (2, 5)=('fluidigmc1', 'inDrop3')
2025-11-02 15:42:46,956 - root - INFO - Processing datasets: (2, 6) = ('fluidigmc1', 'inDrop4')
2025-11-02 15:42:47,018 - root - INFO - There are (7070) MNN pairs when processing (2, 6)=('fluidigmc1', 'inDrop4')
2025-11-02 15:42:47,018 - root - INFO - Processing datasets: (2, 7) = ('fluidigmc1', 'smarter')
2025-11-02 15:42:47,084 - root - INFO - There are (7986) MNN pairs when processing (2, 7)=('fluidigmc1', 'smarter')
2025-11-02 15:42:47,084 - root - INFO - Processing datasets: (2, 8) = ('fluidigmc1', 'smartseq2')
2025-11-02 15:42:47,165 - root - INFO - There are (7196) MNN pairs when processing (2, 8)=('fluidigmc1', 'smartseq2')
2025-11-02 15:42:47,165 - root - INFO - Processing datasets: (3, 4) = ('inDrop1', 'inDrop2')
2025-11-02 15:42:47,258 - root - INFO - There are (12214) MNN pairs when processing (3, 4)=('inDrop1', 'inDrop2')
2025-11-02 15:42:47,258 - root - INFO - Processing datasets: (3, 5) = ('inDrop1', 'inDrop3')
2025-11-02 15:42:47,376 - root - INFO - There are (16106) MNN pairs when processing (3, 5)=('inDrop1', 'inDrop3')
2025-11-02 15:42:47,376 - root - INFO - Processing datasets: (3, 6) = ('inDrop1', 'inDrop4')
2025-11-02 15:42:47,465 - root - INFO - There are (11650) MNN pairs when processing (3, 6)=('inDrop1', 'inDrop4')
2025-11-02 15:42:47,465 - root - INFO - Processing datasets: (3, 7) = ('inDrop1', 'smarter')
2025-11-02 15:42:47,563 - root - INFO - There are (11156) MNN pairs when processing (3, 7)=('inDrop1', 'smarter')
2025-11-02 15:42:47,563 - root - INFO - Processing datasets: (3, 8) = ('inDrop1', 'smartseq2')
2025-11-02 15:42:47,672 - root - INFO - There are (11260) MNN pairs when processing (3, 8)=('inDrop1', 'smartseq2')
2025-11-02 15:42:47,672 - root - INFO - Processing datasets: (4, 5) = ('inDrop2', 'inDrop3')
2025-11-02 15:42:47,791 - root - INFO - There are (15446) MNN pairs when processing (4, 5)=('inDrop2', 'inDrop3')
2025-11-02 15:42:47,791 - root - INFO - Processing datasets: (4, 6) = ('inDrop2', 'inDrop4')
2025-11-02 15:42:47,885 - root - INFO - There are (11466) MNN pairs when processing (4, 6)=('inDrop2', 'inDrop4')
2025-11-02 15:42:47,885 - root - INFO - Processing datasets: (4, 7) = ('inDrop2', 'smarter')
2025-11-02 15:42:48,015 - root - INFO - There are (11972) MNN pairs when processing (4, 7)=('inDrop2', 'smarter')
2025-11-02 15:42:48,015 - root - INFO - Processing datasets: (4, 8) = ('inDrop2', 'smartseq2')
2025-11-02 15:42:48,136 - root - INFO - There are (14388) MNN pairs when processing (4, 8)=('inDrop2', 'smartseq2')
2025-11-02 15:42:48,136 - root - INFO - Processing datasets: (5, 6) = ('inDrop3', 'inDrop4')
2025-11-02 15:42:48,273 - root - INFO - There are (13044) MNN pairs when processing (5, 6)=('inDrop3', 'inDrop4')
2025-11-02 15:42:48,273 - root - INFO - Processing datasets: (5, 7) = ('inDrop3', 'smarter')
2025-11-02 15:42:48,428 - root - INFO - There are (14618) MNN pairs when processing (5, 7)=('inDrop3', 'smarter')
2025-11-02 15:42:48,428 - root - INFO - Processing datasets: (5, 8) = ('inDrop3', 'smartseq2')
2025-11-02 15:42:48,583 - root - INFO - There are (15118) MNN pairs when processing (5, 8)=('inDrop3', 'smartseq2')
2025-11-02 15:42:48,583 - root - INFO - Processing datasets: (6, 7) = ('inDrop4', 'smarter')
2025-11-02 15:42:48,688 - root - INFO - There are (9476) MNN pairs when processing (6, 7)=('inDrop4', 'smarter')
2025-11-02 15:42:48,688 - root - INFO - Processing datasets: (6, 8) = ('inDrop4', 'smartseq2')
2025-11-02 15:42:48,808 - root - INFO - There are (10894) MNN pairs when processing (6, 8)=('inDrop4', 'smartseq2')
2025-11-02 15:42:48,808 - root - INFO - Processing datasets: (7, 8) = ('smarter', 'smartseq2')
2025-11-02 15:42:48,934 - root - INFO - There are (12620) MNN pairs when processing (7, 8)=('smarter', 'smartseq2')
2025-11-02 15:42:48,934 - root - INFO - scDML finds (389370) MNN pairs in dataset finally
2025-11-02 15:42:49,912 - root - INFO - Find All Nearest Neighbours Done....
2025-11-02 15:42:49,912 - root - INFO - calculate similarity matrix between cluster
2025-11-02 15:42:50,034 - root - INFO - delete inner edge which link same cluster
2025-11-02 15:42:50,034 - root - INFO - 20630 knn pair in batch link different cluster
2025-11-02 15:42:50,172 - root - INFO - delete inner edge which link same cluster
2025-11-02 15:42:50,173 - root - INFO - 254482 mnn pair in batch link different cluster
2025-11-02 15:42:50,173 - root - INFO - ===================================================================================
2025-11-02 15:42:50,174 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=12.33553078041687
2025-11-02 15:42:50,175 - root - INFO - ===================================================================================
2025-11-02 15:42:50,178 - root - INFO - save cor matrix to file....
2025-11-02 15:42:50,182 - root - INFO - save nn pair matrix to file
2025-11-02 15:42:50,184 - root - INFO - Calculate Similarity Matrix Done....
2025-11-02 15:42:50,220 - root - INFO - scDML merge cluster with rule2....
2025-11-02 15:42:50,221 - root - INFO - merge_rule2....
2025-11-02 15:42:50,558 - root - INFO - merging cluster set:[{0}, {6}, {14}, {22}, {29}, {33}, {36}, {37}, {38}, {40}, {41}, {17, 21, 9, 15}, {32, 2, 35, 5, 39, 8, 10, 11, 23, 27}, {1, 34, 4, 7, 12, 13, 16, 18, 19, 20, 28, 31}, {3, 24, 25, 26, 30}]
2025-11-02 15:42:50,558 - root - INFO - Build Embedding Net for scDML training
2025-11-02 15:42:50,565 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2025-11-02 15:42:50,565 - root - INFO - Build Embedding Net Done...
2025-11-02 15:42:50,566 - root - INFO - train scDML(expect_num_cluster=15) with Embedding Net
2025-11-02 15:42:50,566 - root - INFO - expect_num_cluster=15
2025-11-02 15:42:50,567 - root - INFO - using GPU to train model
2025-11-02 15:42:50,570 - root - INFO - use euclidean distance and hard triplet to train model
2025-11-02 15:42:50,571 - root - INFO - not use earlystopping!!!!
2025-11-02 15:42:51,834 - root - INFO - epoch=1,number_hard_triplet=154871
2025-11-02 15:42:53,188 - root - INFO - epoch=2,number_hard_triplet=54778
2025-11-02 15:42:54,520 - root - INFO - epoch=3,number_hard_triplet=24228
2025-11-02 15:42:55,808 - root - INFO - epoch=4,number_hard_triplet=13574
2025-11-02 15:42:57,087 - root - INFO - epoch=5,number_hard_triplet=8842
2025-11-02 15:42:58,248 - root - INFO - epoch=6,number_hard_triplet=4848
2025-11-02 15:42:59,368 - root - INFO - epoch=7,number_hard_triplet=3953
2025-11-02 15:43:00,417 - root - INFO - epoch=8,number_hard_triplet=2608
2025-11-02 15:43:01,467 - root - INFO - epoch=9,number_hard_triplet=2490
2025-11-02 15:43:02,434 - root - INFO - epoch=10,number_hard_triplet=1078
2025-11-02 15:43:03,413 - root - INFO - epoch=11,number_hard_triplet=1238
2025-11-02 15:43:04,345 - root - INFO - epoch=12,number_hard_triplet=989
2025-11-02 15:43:05,269 - root - INFO - epoch=13,number_hard_triplet=908
2025-11-02 15:43:06,145 - root - INFO - epoch=14,number_hard_triplet=702
2025-11-02 15:43:07,018 - root - INFO - epoch=15,number_hard_triplet=442
2025-11-02 15:43:07,841 - root - INFO - epoch=16,number_hard_triplet=283
2025-11-02 15:43:08,651 - root - INFO - epoch=17,number_hard_triplet=281
2025-11-02 15:43:09,519 - root - INFO - epoch=18,number_hard_triplet=366
2025-11-02 15:43:10,388 - root - INFO - epoch=19,number_hard_triplet=444
2025-11-02 15:43:11,252 - root - INFO - epoch=20,number_hard_triplet=475
2025-11-02 15:43:12,091 - root - INFO - epoch=21,number_hard_triplet=619
2025-11-02 15:43:12,864 - root - INFO - epoch=22,number_hard_triplet=196
2025-11-02 15:43:13,655 - root - INFO - epoch=23,number_hard_triplet=254
2025-11-02 15:43:14,471 - root - INFO - epoch=24,number_hard_triplet=382
2025-11-02 15:43:15,301 - root - INFO - epoch=25,number_hard_triplet=207
2025-11-02 15:43:16,111 - root - INFO - epoch=26,number_hard_triplet=162
2025-11-02 15:43:16,911 - root - INFO - epoch=27,number_hard_triplet=162
2025-11-02 15:43:17,757 - root - INFO - epoch=28,number_hard_triplet=213
2025-11-02 15:43:18,597 - root - INFO - epoch=29,number_hard_triplet=274
2025-11-02 15:43:19,410 - root - INFO - epoch=30,number_hard_triplet=333
2025-11-02 15:43:20,223 - root - INFO - epoch=31,number_hard_triplet=133
2025-11-02 15:43:21,027 - root - INFO - epoch=32,number_hard_triplet=203
2025-11-02 15:43:21,865 - root - INFO - epoch=33,number_hard_triplet=178
2025-11-02 15:43:22,676 - root - INFO - epoch=34,number_hard_triplet=187
2025-11-02 15:43:23,490 - root - INFO - epoch=35,number_hard_triplet=505
2025-11-02 15:43:24,268 - root - INFO - epoch=36,number_hard_triplet=124
2025-11-02 15:43:25,029 - root - INFO - epoch=37,number_hard_triplet=117
2025-11-02 15:43:25,781 - root - INFO - epoch=38,number_hard_triplet=95
2025-11-02 15:43:26,537 - root - INFO - epoch=39,number_hard_triplet=112
2025-11-02 15:43:27,291 - root - INFO - epoch=40,number_hard_triplet=77
2025-11-02 15:43:28,103 - root - INFO - epoch=41,number_hard_triplet=158
2025-11-02 15:43:28,883 - root - INFO - epoch=42,number_hard_triplet=162
2025-11-02 15:43:29,708 - root - INFO - epoch=43,number_hard_triplet=204
2025-11-02 15:43:30,498 - root - INFO - epoch=44,number_hard_triplet=201
2025-11-02 15:43:31,255 - root - INFO - epoch=45,number_hard_triplet=207
2025-11-02 15:43:32,020 - root - INFO - epoch=46,number_hard_triplet=90
2025-11-02 15:43:32,764 - root - INFO - epoch=47,number_hard_triplet=71
2025-11-02 15:43:33,493 - root - INFO - epoch=48,number_hard_triplet=80
2025-11-02 15:43:34,269 - root - INFO - epoch=49,number_hard_triplet=96
2025-11-02 15:43:35,026 - root - INFO - epoch=50,number_hard_triplet=120
2025-11-02 15:43:35,027 - root - INFO - scDML training done....
2025-11-02 15:43:35,027 - root - INFO - extract embedding for dataset with trained network
5:42:47,672 - root - INFO - There are (11260) MNN pairs when processing (3, 8)=('inDrop1', 'smartseq2')
2025-11-02 15:42:47,672 - root - INFO - Processing datasets: (4, 5) = ('inDrop2', 'inDrop3')
2025-11-02 15:42:47,791 - root - INFO - There are (15446) MNN pairs when processing (4, 5)=('inDrop2', 'inDrop3')
2025-11-02 15:42:47,791 - root - INFO - Processing datasets: (4, 6) = ('inDrop2', 'inDrop4')
2025-11-02 15:42:47,885 - root - INFO - There are (11466) MNN pairs when processing (4, 6)=('inDrop2', 'inDrop4')
2025-11-02 15:42:47,885 - root - INFO - Processing datasets: (4, 7) = ('inDrop2', 'smarter')
2025-11-02 15:42:48,015 - root - INFO - There are (11972) MNN pairs when processing (4, 7)=('inDrop2', 'smarter')
2025-11-02 15:42:48,015 - root - INFO - Processing datasets: (4, 8) = ('inDrop2', 'smartseq2')
2025-11-02 15:42:48,136 - root - INFO - There are (14388) MNN pairs when processing (4, 8)=('inDrop2', 'smartseq2')
2025-11-02 15:42:48,136 - root - INFO - Processing datasets: (5, 6) = ('inDrop3', 'inDrop4')
2025-11-02 15:42:48,273 - root - INFO - There are (13044) MNN pairs when processing (5, 6)=('inDrop3', 'inDrop4')
2025-11-02 15:42:48,273 - root - INFO - Processing datasets: (5, 7) = ('inDrop3', 'smarter')
2025-11-02 15:42:48,428 - root - INFO - There are (14618) MNN pairs when processing (5, 7)=('inDrop3', 'smarter')
2025-11-02 15:42:48,428 - root - INFO - Processing datasets: (5, 8) = ('inDrop3', 'smartseq2')
2025-11-02 15:42:48,583 - root - INFO - There are (15118) MNN pairs when processing (5, 8)=('inDrop3', 'smartseq2')
2025-11-02 15:42:48,583 - root - INFO - Processing datasets: (6, 7) = ('inDrop4', 'smarter')
2025-11-02 15:42:48,688 - root - INFO - There are (9476) MNN pairs when processing (6, 7)=('inDrop4', 'smarter')
2025-11-02 15:42:48,688 - root - INFO - Processing datasets: (6, 8) = ('inDrop4', 'smartseq2')
2025-11-02 15:42:48,808 - root - INFO - There are (10894) MNN pairs when processing (6, 8)=('inDrop4', 'smartseq2')
2025-11-02 15:42:48,808 - root - INFO - Processing datasets: (7, 8) = ('smarter', 'smartseq2')
2025-11-02 15:42:48,934 - root - INFO - There are (12620) MNN pairs when processing (7, 8)=('smarter', 'smartseq2')
2025-11-02 15:42:48,934 - root - INFO - scDML finds (389370) MNN pairs in dataset finally
2025-11-02 15:42:49,912 - root - INFO - Find All Nearest Neighbours Done....
2025-11-02 15:42:49,912 - root - INFO - calculate similarity matrix between cluster
2025-11-02 15:42:50,034 - root - INFO - delete inner edge which link same cluster
2025-11-02 15:42:50,034 - root - INFO - 20630 knn pair in batch link different cluster
2025-11-02 15:42:50,172 - root - INFO - delete inner edge which link same cluster
2025-11-02 15:42:50,173 - root - INFO - 254482 mnn pair in batch link different cluster
2025-11-02 15:42:50,173 - root - INFO - ===================================================================================
2025-11-02 15:42:50,174 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=12.33553078041687
2025-11-02 15:42:50,175 - root - INFO - ===================================================================================
2025-11-02 15:42:50,178 - root - INFO - save cor matrix to file....
2025-11-02 15:42:50,182 - root - INFO - save nn pair matrix to file
2025-11-02 15:42:50,184 - root - INFO - Calculate Similarity Matrix Done....
2025-11-02 15:42:50,220 - root - INFO - scDML merge cluster with rule2....
2025-11-02 15:42:50,221 - root - INFO - merge_rule2....
2025-11-02 15:42:50,558 - root - INFO - merging cluster set:[{0}, {6}, {14}, {22}, {29}, {33}, {36}, {37}, {38}, {40}, {41}, {17, 21, 9, 15}, {32, 2, 35, 5, 39, 8, 10, 11, 23, 27}, {1, 34, 4, 7, 12, 13, 16, 18, 19, 20, 28, 31}, {3, 24, 25, 26, 30}]
2025-11-02 15:42:50,558 - root - INFO - Build Embedding Net for scDML training
2025-11-02 15:42:50,565 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2025-11-02 15:42:50,565 - root - INFO - Build Embedding Net Done...
2025-11-02 15:42:50,566 - root - INFO - train scDML(expect_num_cluster=15) with Embedding Net
2025-11-02 15:42:50,566 - root - INFO - expect_num_cluster=15
2025-11-02 15:42:50,567 - root - INFO - using GPU to train model
2025-11-02 15:42:50,570 - root - INFO - use euclidean distance and hard triplet to train model
2025-11-02 15:42:50,571 - root - INFO - not use earlystopping!!!!
2025-11-02 15:42:51,834 - root - INFO - epoch=1,number_hard_triplet=154871
2025-11-02 15:42:53,188 - root - INFO - epoch=2,number_hard_triplet=54778
2025-11-02 15:42:54,520 - root - INFO - epoch=3,number_hard_triplet=24228
2025-11-02 15:42:55,808 - root - INFO - epoch=4,number_hard_triplet=13574
2025-11-02 15:42:57,087 - root - INFO - epoch=5,number_hard_triplet=8842
2025-11-02 15:42:58,248 - root - INFO - epoch=6,number_hard_triplet=4848
2025-11-02 15:42:59,368 - root - INFO - epoch=7,number_hard_triplet=3953
2025-11-02 15:43:00,417 - root - INFO - epoch=8,number_hard_triplet=2608
2025-11-02 15:43:01,467 - root - INFO - epoch=9,number_hard_triplet=2490
2025-11-02 15:43:02,434 - root - INFO - epoch=10,number_hard_triplet=1078
2025-11-02 15:43:03,413 - root - INFO - epoch=11,number_hard_triplet=1238
2025-11-02 15:43:04,345 - root - INFO - epoch=12,number_hard_triplet=989
2025-11-02 15:43:05,269 - root - INFO - epoch=13,number_hard_triplet=908
2025-11-02 15:43:06,145 - root - INFO - epoch=14,number_hard_triplet=702
2025-11-02 15:43:07,018 - root - INFO - epoch=15,number_hard_triplet=442
2025-11-02 15:43:07,841 - root - INFO - epoch=16,number_hard_triplet=283
2025-11-02 15:43:08,651 - root - INFO - epoch=17,number_hard_triplet=281
2025-11-02 15:43:09,519 - root - INFO - epoch=18,number_hard_triplet=366
2025-11-02 15:43:10,388 - root - INFO - epoch=19,number_hard_triplet=444
2025-11-02 15:43:11,252 - root - INFO - epoch=20,number_hard_triplet=475
2025-11-02 15:43:12,091 - root - INFO - epoch=21,number_hard_triplet=619
2025-11-02 15:43:12,864 - root - INFO - epoch=22,number_hard_triplet=196
2025-11-02 15:43:13,655 - root - INFO - epoch=23,number_hard_triplet=254
2025-11-02 15:43:14,471 - root - INFO - epoch=24,number_hard_triplet=382
2025-11-02 15:43:15,301 - root - INFO - epoch=25,number_hard_triplet=207
2025-11-02 15:43:16,111 - root - INFO - epoch=26,number_hard_triplet=162
2025-11-02 15:43:16,911 - root - INFO - epoch=27,number_hard_triplet=162
2025-11-02 15:43:17,757 - root - INFO - epoch=28,number_hard_triplet=213
2025-11-02 15:43:18,597 - root - INFO - epoch=29,number_hard_triplet=274
2025-11-02 15:43:19,410 - root - INFO - epoch=30,number_hard_triplet=333
2025-11-02 15:43:20,223 - root - INFO - epoch=31,number_hard_triplet=133
2025-11-02 15:43:21,027 - root - INFO - epoch=32,number_hard_triplet=203
2025-11-02 15:43:21,865 - root - INFO - epoch=33,number_hard_triplet=178
2025-11-02 15:43:22,676 - root - INFO - epoch=34,number_hard_triplet=187
2025-11-02 15:43:23,490 - root - INFO - epoch=35,number_hard_triplet=505
2025-11-02 15:43:24,268 - root - INFO - epoch=36,number_hard_triplet=124
2025-11-02 15:43:25,029 - root - INFO - epoch=37,number_hard_triplet=117
2025-11-02 15:43:25,781 - root - INFO - epoch=38,number_hard_triplet=95
2025-11-02 15:43:26,537 - root - INFO - epoch=39,number_hard_triplet=112
2025-11-02 15:43:27,291 - root - INFO - epoch=40,number_hard_triplet=77
2025-11-02 15:43:28,103 - root - INFO - epoch=41,number_hard_triplet=158
2025-11-02 15:43:28,883 - root - INFO - epoch=42,number_hard_triplet=162
2025-11-02 15:43:29,708 - root - INFO - epoch=43,number_hard_triplet=204
2025-11-02 15:43:30,498 - root - INFO - epoch=44,number_hard_triplet=201
2025-11-02 15:43:31,255 - root - INFO - epoch=45,number_hard_triplet=207
2025-11-02 15:43:32,020 - root - INFO - epoch=46,number_hard_triplet=90
2025-11-02 15:43:32,764 - root - INFO - epoch=47,number_hard_triplet=71
2025-11-02 15:43:33,493 - root - INFO - epoch=48,number_hard_triplet=80
2025-11-02 15:43:34,269 - root - INFO - epoch=49,number_hard_triplet=96
2025-11-02 15:43:35,026 - root - INFO - epoch=50,number_hard_triplet=120
2025-11-02 15:43:35,027 - root - INFO - scDML training done....
2025-11-02 15:43:35,027 - root - INFO - extract embedding for dataset with trained network

2025-11-02 15:42:47,672 - root - INFO - There are (11260) MNN pairs when processing (3, 8)=('inDrop1', 'smartseq2')
2025-11-02 15:42:47,672 - root - INFO - Processing datasets: (4, 5) = ('inDrop2', 'inDrop3')
2025-11-02 15:42:47,791 - root - INFO - There are (15446) MNN pairs when processing (4, 5)=('inDrop2', 'inDrop3')
2025-11-02 15:42:47,791 - root - INFO - Processing datasets: (4, 6) = ('inDrop2', 'inDrop4')
2025-11-02 15:42:47,885 - root - INFO - There are (11466) MNN pairs when processing (4, 6)=('inDrop2', 'inDrop4')
2025-11-02 15:42:47,885 - root - INFO - Processing datasets: (4, 7) = ('inDrop2', 'smarter')
2025-11-02 15:42:48,015 - root - INFO - There are (11972) MNN pairs when processing (4, 7)=('inDrop2', 'smarter')
2025-11-02 15:42:48,015 - root - INFO - Processing datasets: (4, 8) = ('inDrop2', 'smartseq2')
2025-11-02 15:42:48,136 - root - INFO - There are (14388) MNN pairs when processing (4, 8)=('inDrop2', 'smartseq2')
2025-11-02 15:42:48,136 - root - INFO - Processing datasets: (5, 6) = ('inDrop3', 'inDrop4')
2025-11-02 15:42:48,273 - root - INFO - There are (13044) MNN pairs when processing (5, 6)=('inDrop3', 'inDrop4')
2025-11-02 15:42:48,273 - root - INFO - Processing datasets: (5, 7) = ('inDrop3', 'smarter')
2025-11-02 15:42:48,428 - root - INFO - There are (14618) MNN pairs when processing (5, 7)=('inDrop3', 'smarter')
2025-11-02 15:42:48,428 - root - INFO - Processing datasets: (5, 8) = ('inDrop3', 'smartseq2')
2025-11-02 15:42:48,583 - root - INFO - There are (15118) MNN pairs when processing (5, 8)=('inDrop3', 'smartseq2')
2025-11-02 15:42:48,583 - root - INFO - Processing datasets: (6, 7) = ('inDrop4', 'smarter')
2025-11-02 15:42:48,688 - root - INFO - There are (9476) MNN pairs when processing (6, 7)=('inDrop4', 'smarter')
2025-11-02 15:42:48,688 - root - INFO - Processing datasets: (6, 8) = ('inDrop4', 'smartseq2')
2025-11-02 15:42:48,808 - root - INFO - There are (10894) MNN pairs when processing (6, 8)=('inDrop4', 'smartseq2')
2025-11-02 15:42:48,808 - root - INFO - Processing datasets: (7, 8) = ('smarter', 'smartseq2')
2025-11-02 15:42:48,934 - root - INFO - There are (12620) MNN pairs when processing (7, 8)=('smarter', 'smartseq2')
2025-11-02 15:42:48,934 - root - INFO - scDML finds (389370) MNN pairs in dataset finally
2025-11-02 15:42:49,912 - root - INFO - Find All Nearest Neighbours Done....
2025-11-02 15:42:49,912 - root - INFO - calculate similarity matrix between cluster
2025-11-02 15:42:50,034 - root - INFO - delete inner edge which link same cluster
2025-11-02 15:42:50,034 - root - INFO - 20630 knn pair in batch link different cluster
2025-11-02 15:42:50,172 - root - INFO - delete inner edge which link same cluster
2025-11-02 15:42:50,173 - root - INFO - 254482 mnn pair in batch link different cluster
2025-11-02 15:42:50,173 - root - INFO - ===================================================================================
2025-11-02 15:42:50,174 - root - INFO - NN pair ratio(number of MNN pairs/number of KNN pairs)=12.33553078041687
2025-11-02 15:42:50,175 - root - INFO - ===================================================================================
2025-11-02 15:42:50,178 - root - INFO - save cor matrix to file....
2025-11-02 15:42:50,182 - root - INFO - save nn pair matrix to file
2025-11-02 15:42:50,184 - root - INFO - Calculate Similarity Matrix Done....
2025-11-02 15:42:50,220 - root - INFO - scDML merge cluster with rule2....
2025-11-02 15:42:50,221 - root - INFO - merge_rule2....
2025-11-02 15:42:50,558 - root - INFO - merging cluster set:[{0}, {6}, {14}, {22}, {29}, {33}, {36}, {37}, {38}, {40}, {41}, {17, 21, 9, 15}, {32, 2, 35, 5, 39, 8, 10, 11, 23, 27}, {1, 34, 4, 7, 12, 13, 16, 18, 19, 20, 28, 31}, {3, 24, 25, 26, 30}]
2025-11-02 15:42:50,558 - root - INFO - Build Embedding Net for scDML training
2025-11-02 15:42:50,565 - root - INFO - EmbeddingNet(
  (actn): ReLU()
  (fc): Sequential(
    (0): Linear(in_features=1000, out_features=256, bias=True)
    (1): ReLU()
    (2): Linear(in_features=256, out_features=32, bias=True)
  )
)
2025-11-02 15:42:50,565 - root - INFO - Build Embedding Net Done...
2025-11-02 15:42:50,566 - root - INFO - train scDML(expect_num_cluster=15) with Embedding Net
2025-11-02 15:42:50,566 - root - INFO - expect_num_cluster=15
2025-11-02 15:42:50,567 - root - INFO - using GPU to train model
2025-11-02 15:42:50,570 - root - INFO - use euclidean distance and hard triplet to train model
2025-11-02 15:42:50,571 - root - INFO - not use earlystopping!!!!
2025-11-02 15:42:51,834 - root - INFO - epoch=1,number_hard_triplet=154871
2025-11-02 15:42:53,188 - root - INFO - epoch=2,number_hard_triplet=54778
2025-11-02 15:42:54,520 - root - INFO - epoch=3,number_hard_triplet=24228
2025-11-02 15:42:55,808 - root - INFO - epoch=4,number_hard_triplet=13574
2025-11-02 15:42:57,087 - root - INFO - epoch=5,number_hard_triplet=8842
2025-11-02 15:42:58,248 - root - INFO - epoch=6,number_hard_triplet=4848
2025-11-02 15:42:59,368 - root - INFO - epoch=7,number_hard_triplet=3953
2025-11-02 15:43:00,417 - root - INFO - epoch=8,number_hard_triplet=2608
2025-11-02 15:43:01,467 - root - INFO - epoch=9,number_hard_triplet=2490
2025-11-02 15:43:02,434 - root - INFO - epoch=10,number_hard_triplet=1078
2025-11-02 15:43:03,413 - root - INFO - epoch=11,number_hard_triplet=1238
2025-11-02 15:43:04,345 - root - INFO - epoch=12,number_hard_triplet=989
2025-11-02 15:43:05,269 - root - INFO - epoch=13,number_hard_triplet=908
2025-11-02 15:43:06,145 - root - INFO - epoch=14,number_hard_triplet=702
2025-11-02 15:43:07,018 - root - INFO - epoch=15,number_hard_triplet=442
2025-11-02 15:43:07,841 - root - INFO - epoch=16,number_hard_triplet=283
2025-11-02 15:43:08,651 - root - INFO - epoch=17,number_hard_triplet=281
2025-11-02 15:43:09,519 - root - INFO - epoch=18,number_hard_triplet=366
2025-11-02 15:43:10,388 - root - INFO - epoch=19,number_hard_triplet=444
2025-11-02 15:43:11,252 - root - INFO - epoch=20,number_hard_triplet=475
2025-11-02 15:43:12,091 - root - INFO - epoch=21,number_hard_triplet=619
2025-11-02 15:43:12,864 - root - INFO - epoch=22,number_hard_triplet=196
2025-11-02 15:43:13,655 - root - INFO - epoch=23,number_hard_triplet=254
2025-11-02 15:43:14,471 - root - INFO - epoch=24,number_hard_triplet=382
2025-11-02 15:43:15,301 - root - INFO - epoch=25,number_hard_triplet=207
2025-11-02 15:43:16,111 - root - INFO - epoch=26,number_hard_triplet=162
2025-11-02 15:43:16,911 - root - INFO - epoch=27,number_hard_triplet=162
2025-11-02 15:43:17,757 - root - INFO - epoch=28,number_hard_triplet=213
2025-11-02 15:43:18,597 - root - INFO - epoch=29,number_hard_triplet=274
2025-11-02 15:43:19,410 - root - INFO - epoch=30,number_hard_triplet=333
2025-11-02 15:43:20,223 - root - INFO - epoch=31,number_hard_triplet=133
2025-11-02 15:43:21,027 - root - INFO - epoch=32,number_hard_triplet=203
2025-11-02 15:43:21,865 - root - INFO - epoch=33,number_hard_triplet=178
2025-11-02 15:43:22,676 - root - INFO - epoch=34,number_hard_triplet=187
2025-11-02 15:43:23,490 - root - INFO - epoch=35,number_hard_triplet=505
2025-11-02 15:43:24,268 - root - INFO - epoch=36,number_hard_triplet=124
2025-11-02 15:43:25,029 - root - INFO - epoch=37,number_hard_triplet=117
2025-11-02 15:43:25,781 - root - INFO - epoch=38,number_hard_triplet=95
2025-11-02 15:43:26,537 - root - INFO - epoch=39,number_hard_triplet=112
2025-11-02 15:43:27,291 - root - INFO - epoch=40,number_hard_triplet=77
2025-11-02 15:43:28,103 - root - INFO - epoch=41,number_hard_triplet=158
2025-11-02 15:43:28,883 - root - INFO - epoch=42,number_hard_triplet=162
2025-11-02 15:43:29,708 - root - INFO - epoch=43,number_hard_triplet=204
2025-11-02 15:43:30,498 - root - INFO - epoch=44,number_hard_triplet=201
2025-11-02 15:43:31,255 - root - INFO - epoch=45,number_hard_triplet=207
2025-11-02 15:43:32,020 - root - INFO - epoch=46,number_hard_triplet=90
2025-11-02 15:43:32,764 - root - INFO - epoch=47,number_hard_triplet=71
2025-11-02 15:43:33,493 - root - INFO - epoch=48,number_hard_triplet=80
2025-11-02 15:43:34,269 - root - INFO - epoch=49,number_hard_triplet=96
2025-11-02 15:43:35,026 - root - INFO - epoch=50,number_hard_triplet=120
2025-11-02 15:43:35,027 - root - INFO - scDML training done....
2025-11-02 15:43:35,027 - root - INFO - extract embedding for dataset with trained network
